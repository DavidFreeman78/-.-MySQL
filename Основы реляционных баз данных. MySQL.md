--Lesson_7 (1-2)

use lesson_5;

-- Вставим данные в таблицу orders
INSERT INTO orders (user_id) VALUES (6),(1),(6),(4),(2),(6),(5);


/* Задача 1
Составьте список пользователей users, которые осуществили хотя бы один заказ orders в интернет магазине
*/

SELECT *, (SELECT count(*) FROM orders WHERE user_id=u.id) as count_orders 
FROM users as u
HAVING count_orders >= 1;

/* Задача 2
Выведите список товаров products и разделов catalogs, который соответствует товару.
*/

SELECT p.name,c.name FROM products as p
	LEFT JOIN catalogs as c ON (p.catalog_id=c.id);
	
--Lesson_7 (3)

use lesson_7;

/* Задача 3
(по желанию) Пусть имеется таблица рейсов flights (id, from, to) и таблица городов cities (label, name). 
Поля from, to и label содержат английские названия городов, поле name — русское. 
Выведите список рейсов flights с русскими названиями городов.
*/

-- Создаю таблицы

DROP TABLE IF EXISTS flights;
DROP TABLE IF EXISTS cities;

CREATE TABLE flights (
  id INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  `from` VARCHAR(255) NOT NULL,
  `to` VARCHAR(255) NOT NULL
);

CREATE TABLE cities (
  label VARCHAR(255) NOT NULL PRIMARY KEY,
  name VARCHAR(255) NOT NULL
);

-- Добавляю значения в таблицы

INSERT INTO flights VALUES 
	(1,'moscow','omsk'),
	(2,'novgorod','kazan'),
	(3,'irkutsk','moscow'),
	(4,'omsk','irkutsk'),
	(5,'moscow','kazan')
;

INSERT INTO cities VALUES 
	('moscow','Москва'),
	('irkutsk','Иркутск'),
	('novgorod','Новгород'),
	('kazan','Казань'),
	('omsk','Омск')
;
