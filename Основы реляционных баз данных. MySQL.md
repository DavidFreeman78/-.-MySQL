--Lesson_7

use lesson_5;

-- Вставим данные в таблицу orders
INSERT INTO orders (user_id) VALUES (6),(1),(6),(4),(2),(6),(5);


/* Задача 1
Составьте список пользователей users, которые осуществили хотя бы один заказ orders в интернет магазине
*/

SELECT *, (SELECT count(*) FROM orders WHERE user_id=u.id) as count_orders 
FROM users as u
HAVING count_orders >= 1;

/* Задача 2
Выведите список товаров products и разделов catalogs, который соответствует товару.
*/

SELECT p.name,c.name FROM products as p
	LEFT JOIN catalogs as c ON (p.catalog_id=c.id);
	
